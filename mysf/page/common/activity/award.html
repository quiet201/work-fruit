<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>填写个人资料</title>
<link rel="stylesheet" href="../../../../css/common/public.css">
<link rel="stylesheet" href="../../../../css/common/sf02.css">
<link rel="stylesheet" href="../../../../css/common/tips.css"/>
</head>

<body>
<div id="wrapper">

    <!-- header s11 -->
    <header>
    	<span class="btn-topl"><a class="ui-btn btn-back" href="javascript: history.go(-1);"><i class="ui-ico-sfi ico-back"></i></a></span>
        <h1>填写个人资料</h1>
    </header>
    <!-- header e -->
    
    <section>
    	<form>
    	 <input type="hidden" id="id" name="id"/>
    	<ul class="ui-fm border-top0">
    		<li class="item item-fm">
                <div class="ui-flex" style="padding: 10px 0; text-align: center;">
                    <div class="flex-ico">
	                    <span class="tip-text">带</span>
	                    <span class="colorred">*</span>
	                    <span class="tip-text">为必填项,您的个人信息顺丰会为您严格保密</span>
                    </div>
                    
                </div>
            </li>
            <li class="item item-fm"  id="item_item-fm_id" style="display:none">
                <div class="ui-flex">
                    <div class="flex-ico"><span class="must2"></span><label style="width:80px"><span class="lable-fontStyle">中奖手机号</span></label></div>
                    <div class="flex-con">
                    	<input type="text" id="userMobile"  name="userMobile" class="input-text" value="" placeholder="" />
                    </div>
                </div>
            </li>
    		<li class="item item-fm">
                <div class="ui-flex">
                    <div class="flex-ico"><span class="must2"></span><label><span class="lable-fontStyle">姓名</span></label></div>
                    <div class="flex-con">
                    	<input type="text" id="userName" name="userName" class="input-text" value="" placeholder="" />
                    </div>
                </div>
            </li>
            <li class="item item-fm">
                <div class="ui-flex">
                    <div class="flex-ico"><span class="must2"></span><label style="width:80px"><span class="lable-fontStyle">领奖手机号</span></label></div>
                    <div class="flex-con">
                    	<input type="text" id="userPhone"  name="userPhone" class="input-text" value="" placeholder="" />
                    </div>
                </div>
            </li>
            <li class="item item-fm"  id="destinationDiv">
                <div class="ui-flex">
                    <div class="flex-ico"><span class="must2"></span><label><span class="lable-fontStyle">省市区</span></label></div>
                    <div class="flex-con" onclick="toSelectDestination();">
                    	<!-- <a class="ui-btn-right03" data-toggle="datePicker" href="javascript:void(0);" onClick="toSelectDestination()">
                    	    <span id="destination" class="fill"></span>
                        </a> -->
                        
                    	<a class="ui-btn-right03" data-toggle="datePicker" href="javascript:void(0);" onClick="toSelectDestination()">                   		
                         <div id="destination" class="fill placeholder font01" style="padding: 10px 0;">请选择地区</div>                         
                        </a>
                    
                            <input type="hidden" id="provinceName"/>
	                        <input type="hidden" id="provinceCode"/>
	                        <input type="hidden" id="cityName"/>
	                        <input type="hidden" id="cityCode"/>
	                        <input type="hidden" id="countyName"/>
	                        <input type="hidden" id="countyCode"/>
                    </div>
               
            </li>
            <li class="item item-fm">
                <div class="ui-flex">
                    <div class="flex-ico"><span class="must2"></span><label><span class="lable-fontStyle">详细地址</span></label></div>
                    <div class="flex-con">
                    	<textarea id="userReceiveAddress"  name="userReceiveAddress"  class="text-add" ></textarea>
                    </div>
                </div>
            </li>
            <li class="item item-fm">
                <div class="ui-flex">
                    <div class="flex-ico"><label><span class="lable-fontStyle">备注</span></label></div>
                    <div class="flex-con">
                    	<textarea id="remark"  name="remark"  class="text-add" placeholder="请填写收货相关说明信息，比如：男女款鞋码、衣服码数等" maxlength="100"></textarea>
                    </div>
                </div>
            </li>
            <!-- 
            <li class="item item-fm">
                <div class="ui-flex">
                    <div class="flex-ico"><label><span class="lable-fontStyle">邮政编码</span></label></div>
                    <div class="flex-con">
                    	<input type="text" id="userZipCode"  name="userZipCode" class="input-text" value="" placeholder="" />
                    </div>
                </div>
            </li>
             -->
        </ul>
        <div class="grid-btn">
        	<a class="ui-btn btn-submit" id="addButon" >提交</a>
        </div>
        </form>
    </section>
    
</div>
<div class="pop-tips" hidden="true" id="errorMsg">
    <div class="tips">
    	<img src="../../../css/common/img/warning.png"><p id="errorInfo"></p>
    </div>
    </div>
    
    <div class="pop-tips" hidden="true" id="success">
    <div class="tips">
    	<img src="../../../css/common/img/success.png"><p id="MsgInfo"></p>
    </div>
    </div>
</body>
</html>
<script src="/js/baiduState.js"></script>
<script type="text/javascript" src="/js/common/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="/js/common/util/util.js"></script>
<script type="text/javascript" src="/js/common/util/common.js"></script>
<script type="text/javascript" src="/js/common/activity/award.js"></script>

<script>

$(document).ready(function(){
	var v_id = getUrlValueByKey("id");
	if(v_id!="" && v_id!=null ){
		//清空缓存
		setCookie("userInfo",JSON.stringify({}));
		setCookie("destinationInfo",JSON.stringify({}));
		setCookie("status",JSON.stringify({}));
	}
	//初始化加载地址信息
	fillAddress();
	fillUserInfo();
	//$("#id").val("20007");
	
	var uInfo = getCookie("userInfo");	
	if(uInfo && uInfo != null){
		uInfo = $.parseJSON(uInfo);
	}
	if(uInfo.flag!="1"){
		$("#id").val(v_id);
		getUserJoinInfo($("#id").val());
		var status = getCookie("status");
		if(status=="noLogin"){
			$("#item_item-fm_id").show();
		}	
	}else{
		var status = getCookie("status");
		if(status=="noLogin"){
			$("#item_item-fm_id").show();
		}	
		$("#id").val(uInfo.id);
	}
});

function toSelectDestination(){
	//将用户信息保存到 cookie 中
	saveUserInfoToCookie();
	
	getAddressDetail('../../common/address/province.html?addrName=destName&addrCode=destCode&addrCountyName=dcountyName&addrCountyCode=dcountyCode&type=3&gatChild=-1');
}

function saveUserInfoToCookie(){
	var userInfo = {};
	userInfo["id"] = $("#id").val();
	userInfo["userName"] = $("#userName").val();				
	userInfo["userPhone"] = $("#userPhone").val();
	userInfo["remark"] = $("#remark").val();	
	userInfo["userMobile"] = $("#userMobile").val();
	userInfo["flag"] = "1";
	
	setCookie("userInfo",JSON.stringify(userInfo));
}

/**
 * 填充订单信息
 */
function fillUserInfo(){
	var userInfo = getCookie("userInfo");
	if(userInfo && userInfo != null){
		userInfo = $.parseJSON(userInfo);
		 $("#userName").val(userInfo.userName);
		 $("#userPhone").val(userInfo.userPhone);
		 $("#remark").val(userInfo.remark);
		 $("#userMobile").val(userInfo.userMobile);
	}
	
}
//填充寄件人信息
function fillAddress(){
	var provinceName = getUrlValueByKey("proName");//省份名称
	var provinceCode = getUrlValueByKey("proCode");//省份编码
	var cityName = getUrlValueByKey("destName");//城市名称
	var cityCode = getUrlValueByKey("destCode");//城市编码
	var contyName = getUrlValueByKey("dcountyName");//区县名称
	var contyCode = getUrlValueByKey("dcountyCode");//区县编码
	var destination = fillNull(getUrlValueByKey("proName")) + " "
	+ fillNull(getUrlValueByKey("destName")) + " "
	+ fillNull(getUrlValueByKey("dcountyName"));
	//alert(destination);
	if($.trim(destination) != null && $.trim(destination) != ""){
		//设置页面文本
		$("#destination").removeClass("placeholder");
		$("#destination").text(destination); 
		
    
		//设置隐藏域信息
		$("#provinceName").val(provinceName);
		$("#provinceCode").val(provinceCode);
		$("#cityName").val(cityName);
		$("#cityCode").val(cityCode);
		$("#countyName").val(contyName);
		$("#countyCode").val(contyCode);
		
		var destinationInfo = {};
		destinationInfo["provinceName"]= provinceName;
		destinationInfo["provinceCode"]= provinceCode;
		destinationInfo["cityName"]= cityName;
		destinationInfo["cityCode"]= cityCode;
		destinationInfo["contyName"]= contyName;
		destinationInfo["countyCode"]= contyCode;
		
		//将目的地信息保存到cookie中
		setCookie("destinationInfo",JSON.stringify(destinationInfo));
	} else {
		//从Cookie中读取目的地信息
		var destinationInfo = getCookie("destinationInfo");

		if(destinationInfo && destinationInfo != null){
			destinationInfo = $.parseJSON(destinationInfo);
			destination = fillNull(destinationInfo.provinceName) +" " 
			+ fillNull(destinationInfo.cityName) + " " 
			+ fillNull(destinationInfo.contyName);
			//设置页面文本
			if($.trim(destination)!=""){
				$("#destination").text(destination); 
			}
			
			//设置隐藏域信息
			$("#provinceName").val(destinationInfo.provinceName);
			$("#provinceCode").val(destinationInfo.provinceCode);
			$("#cityName").val(destinationInfo.cityName);
			$("#cityCode").val(destinationInfo.cityCode);
			$("#countyName").val(destinationInfo.contyName);
			$("#countyCode").val(destinationInfo.contyCode);
		}
	}
	
}
</script>
<script type="text/javascript" src="/js/common/baiduState.js"></script>
