<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>查看运单资料</title>
<link rel="stylesheet" href="../../../css/common/public.css">
<link rel="stylesheet" href="../../../css/common/sf02.css">


</head>

<body class="sf">
<div id="wrapper">

    <!-- header s -->
    <header>
    	<span class="btn-topl"><a class="ui-btn btn-back" href="javascript: history.go(-1);"><i class="ui-ico-sfi ico-back"></i></a></span>
        <h1>查看运单资料</h1>
    </header>
    <!-- header e -->
    
    <section >
    	<ul class="ui-waybill">
        	<li class="item">
            	<div class="ui-flex01">
                	<div class="sflogo"><img src="../../../../css/common/img/sflogo02.png" width="80" height="28"></div>
                    <div class="nurber" id="waybill-num"></div>
                </div>
            </li>
            <li class="xuxian-content">
                	<div class="flex-ico" ><span id="startAdd"></span> <span class="color01">——</span><i class="ui-ico-sfi ico-car"><span class="color01">—— </span><span id="endAdd"></span></i></div>
            </li>
           </ul>
        </section>
        <section > 
	           <ul>   
	            <li class=" msg-content02" style="padding: 10px 3%;">
	            	<div class="ui-flex" id="consignorContName" style="line-height: 30px;">
	                	
	                </div>
	            </li> 
	            
	            <!-- <li class="item msg-content" >
	            	<div class="ui-flex" id="consignorContName" >
	                	
	                </div>
	            </li> -->
	            
	        </ul>
   		</section>
    
    
    <section>
        <!-- 没有运单资料 -->
    	<ul class="ui-fm" id="noOrderImg" hidden="true">
        	<li class="item item-fm-m" >
            	<div class=" title-latest">运单资料</div>
            	
            </li>
            
            <!-- 没有运单资料 -->
            <li class="item item-fm" id="noHistoryResult" >
                <div class="ui-flex div-padding-top-buttom10">
                    <div class="inner-banner img-div">
                    	<img src="/css/common/img/people01.png" alt="">
                    </div>
                </div>
                <div class="ui-text-center">
                		<p class="text-fontStyle">订单资料暂未上传~</p>
                </div>
                <div class="ui-text-center text-fontStyle2 " style="padding-bottom: 55px;">
                		<p>稍后再来查看吧</p>
                </div>
            </li>
        </ul>
        
        <ul class="ui-fm" id="img" >
        	<li class="item item-fm-m" >
            	
            	<div class=" title-latest">
            	<span>运单资料</span>
            	<!-- <a class="btn-rotation" id="arr_left" onclick="rotate('myimg','left')"><i class="ui-ico-sfi ico-rotation"></i>旋转</a></div> -->
            </li>
            
            <!-- 有运单资料 -->
            <li class="item item-fm" >
                <div class="ui-flex div-padding-top-buttom10" >
                    <div class="img-div2" >
                    	<!--<img src="/css/common/img/waybill-data.jpg" alt="" id="pic_xz">--> 
                    	<img src="" id="pic_xz"/>
                    	<!-- <div class="box-yc02"><img src="/css/common/img/qrocde-watermark.png"></div> -->
                    </div>
                    
                </div>
                
            </li>
        </ul>
       
    </section>

</div>
<!-- 公共页面 -->
<div id="commonPage"></div>
<!--  <a href="/page/alipay/index.html" class="cd-Home"><span class="ui-ico-sfi ico-home"></span></a> -->
<!-- js引入 -->
<script type="text/javascript" src="/js/common/jquery-1.7.2.min.js"></script>

<script type="text/javascript" src="/js/common/util/util.js"></script>
<script type="text/javascript" src="/js/common/util/common.js"></script>
<script type="text/javascript" src="/js/common/baiduState.js"></script>
<!-- <div class="ad"  id="testPosition001" class="replaces">
             <a href="/page/alipay/advice/advice114.html">
	     	 <img src="../../../../image/alipay/chajian_banner.jpg" >
	      </a>
         </div> -->
 <script type="text/javascript">  
<!--  
var isIE = /*@cc_on!@*/!1;  
function rotationPicture(img){  
if (!img) return;  
this._img = typeof img == 'string'?document.getElementById(img):img;  
this.r = 1;  
this.addBtn();  
this.bind();  
}  
rotationPicture.prototype.addBtn = function(){  
this._rRight = document.createElement('input');  
this._rRight.setAttribute('id','rRight');  
this._rRight.setAttribute('type','button');  
this._rRight.setAttribute('value','旋转');  
this._rRight.className = 'rotation';  
if (!isIE){  
var canvas = document.createElement('CANVAS');  
var ctx = canvas.getContext('2d'); 

canvas.setAttribute('width',this._img.naturalWidth);  
canvas.setAttribute('height',this._img.naturalHeight);  
ctx.drawImage(this._img,0,0);  
this._ghost = this._img;  
this._img.parentNode.replaceChild(canvas,this._img);  
this._img = canvas;  
}  
this._img.parentNode.insertBefore(this._rRight,this._img);  
};  
rotationPicture.prototype.bind = function(){  
var _this = this;  
if (window.attachEvent){  
this._rRight.attachEvent('onclick',rotation);  
}else{  
this._rRight.addEventListener('click',rotation,false);  
}  
  
function rotation(){  
if (_this.r > 1) _this.r = 0;  
if(isIE){  
_this._img.style.filter = 'progid:DXImageTransform.Microsoft.BasicImage(Rotation=' + _this.r + ')';  
}else{  
var ctx = _this._img.getContext('2d');  
switch (_this.r){  
case 0:  
_this._img.setAttribute('width',_this._ghost.width);  
_this._img.setAttribute('height',_this._ghost.height);  
ctx.drawImage(_this._ghost,0,0);  
break;  
case 1:  
_this._img.setAttribute('width',_this._ghost.height);  
_this._img.setAttribute('height',_this._ghost.width);  
ctx.rotate(270*Math.PI/180);  
ctx.drawImage(_this._ghost,-_this._ghost.width,0);  
break;  
/*case 2:  
_this._img.setAttribute('width',_this._ghost.width);  
_this._img.setAttribute('height',_this._ghost.height);  
ctx.rotate(180*Math.PI/180);  
ctx.drawImage(_this._ghost,-_this._ghost.width,-_this._ghost.height);  
break;  
case 3:  
_this._img.setAttribute('width',_this._ghost.height);  
_this._img.setAttribute('height',_this._ghost.width);  
ctx.rotate(270*Math.PI/180);  
ctx.drawImage(_this._ghost,-_this._ghost.width,0);  
break; */ 
}  
}  
_this.r++;  
}  
};  
  
//打开调用函数  
window.onload = function(){  
var ir = new rotationPicture('pic_xz');
};  



	
	
	//ImageServer.jsp



function init() {
	//getUrlParams(urlParams);
	/* $("#bno").text(urlParams.bno);
	$("#twoImage").attr("src",urlParams.twoImageUrl);
	$("#dowloadImage").attr("href",urlParams.twoImageUrl); */
}
// 获取地址栏参数
function getUrlParams(urlParams) {
	var url = window.location.search;
	if (url.indexOf("?") != -1) {
		var str = url.substr(1);
		strs = str.split("&");
		for (var i = 0; i < strs.length; i++) {
			if ([ strs[i].split("=")[0] ] == "bno") {
				urlParams.bno = unescape($.trim(strs[i].split("=")[1]));		
			}
			if ([ strs[i].split("=")[0] ] == "fromCity") {
				urlParams.fromCity = decodeURI(unescape(strs[i].split("=")[1]));
			}
			if ([ strs[i].split("=")[0] ] == "toCity") {
				urlParams.toCity = decodeURI(unescape(strs[i].split("=")[1]));		
			}
	
		}
	}
}
$(function() {
	//加日志
	$.post("/service/commonLog/addLog/L00206");
	//加载公共资源,并执行初始化方法
	getDescPage("commonPage","/page/common/tips/tips.html",'init');	
	var urlParams = {
			bno : "",
			hasRoute : true,
			openId : "",
			fromCity:"",
			toCity:""
		};
	
	var ruleConfig={
			routeState:"",
			routeData :"",//路由信息
			ruleState : "",
			ruleData  :""//规则信息
	}; 
	getUrlParams(urlParams);
	
	
	
	getDate(urlParams.fromCity,urlParams.toCity);
	
	createImg(urlParams.bno);
});


   function createImg(bnos){
	   $('#pic_xz').attr('src','/service/createOrderImage?bno='+bnos);	
	   $.ajax({
			type : "POST",
			data : {
				bno : bnos
			},
			dataType : "json",
			url : "/service/delivery/arrive/getWaybillImage/" + bnos ,
			success : function(data) {
				$("#waitplease1").hide();
				if ($.trim(data) != "") {
					if(data=="false"){
						$("#img").hide();
						$('#noOrderImg').show();
					}else{
						$("#img").show();
						$('#noOrderImg').hide();
					}
				
				getCommonImg("10531","N","1");
			 }
			}
			
		});
	   
   }


	
	function getDate(fromCity,toCity) {
		$("#startAdd").text(
				fillNull(fromCity));
		$("#endAdd").text(fillNull(toCity));
		
	}	 
		

  
</script>   
</body>
</html>
